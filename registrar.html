<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen">
      body {
        left: 0px;
      	top: 0px;
      	width: 100%;
      	height: 100%;
        background-color: #000000
        color: white
      }
      select, input {
        margin: 2vh;
        border: 2px solid white
      }
    </style>
  </head>
  <body>
    <input type="button" id="inicio" value="Inicio" onclick="location.reload()" style='position:fixed;left:0%;top:0%;z-index:1000;margin:1vw'>
    <form autocomplete="off" class="contenedor" action="/registrar" method="post" id='formularioregistro' style="border-style: solid; border-width: 5px; border-radius: 5px;">
      <input type="number" name='documento' id="documento" placeholder="Documento del cliente" autofocus> <img id='alert1' src="alert" alt="Alert" style="width:16px;height:16px;"><br>
      <input type="date" name='nacimiento' id="nacimiento"> <img id='alert2' src="alert" alt="Alert" style="width:16px;height:16px;"><br>
      <select name='sexo' id='sexo' style='width:30%'>
        <option value="" disabled selected>Seleccione</option>
        <option value="m">Masculino</option>
        <option value="f">Femenino</option>
        <option value="o">Otro</option>
      </select> <img id='alert3' src="alert" alt="Alert" style="width:16px;height:16px;"><br>
      <input type="text" name="localidad" id="localidad" placeholder="Localidad"> <img id='alert4' src="alert" alt="Alert" style="width:16px;height:16px;"><br>
      <input type="text" name="tarjeta" id="tarjeta" placeholder="Pase tarjeta para completar"> <img id='alert5' src="alert" alt="Alert" style="width:16px;height:16px;"><br>
      <input type="button" id='cargar' value="Cargar">
    </form>
  </body>
</html>

<script
  src="/jquery-3.4.1.min.js"></script>

<script src="http://localhost:4000/socket.io/socket.io.js"></script>

<script type="text/javascript">
  $('#documento').on('input', function() {
    if ($('#documento').val().length < 7){
      $('#alert1').show('slow');
    } else {
      $('#alert1').hide('slow');
    }
  })
  $('#nacimiento').on('change', function() {
    if ($('#nacimiento').val() == ''){
      $('#alert2').show('slow');
    } else {
      $('#alert2').hide('slow');
    }
  })
  $('#sexo').on('change', function() {
    $('#alert3').hide('slow');
  })
  $('#localidad').on('input', function() {
    if ($('#localidad').val().length < 2){
      $('#alert4').show('slow');
    } else {
      $('#alert4').hide('slow');
    }
  })
  document.getElementById('cargar').addEventListener("click", function() {
    if (validateForm()) {
      document.getElementById('formularioregistro').submit();
    } else {
      alert("Revisar campos");

    }

  });
  function validateForm() {
    if ($('#alert1').is(':visible') || $('#alert2').is(':visible') || $('#alert3').is(':visible') || $('#alert4').is(':visible')) {
      return(false);
    } else {
      return(true);
    }
  }

  jQuery(function($){
    var socket = io.connect('http://localhost:4000');
    socket.on('rfid', function(rfidtag) {
      $('#tarjeta').val(rfidtag);
      $('#alert5').hide('slow');
    })
  });
</script>
